<div class="checkout-digift" id="checkout-digift">
<div class="checkout-digift_btn<?if($arResult['BLOCK_DIGIFT_VIEW']) echo ' active';?>">
    <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M2.2619 9.04653C2.51175 9.04653 2.71429 9.24906 2.71429 9.4989V18.094H16.2857V9.4989C16.2857 9.24906 16.4883 9.04653 16.7381 9.04653C16.9879 9.04653 17.1905 9.24906 17.1905 9.4989V18.5464C17.1905 18.7962 16.9879 18.9988 16.7381 18.9988H2.2619C2.01206 18.9988 1.80952 18.7962 1.80952 18.5464V9.4989C1.80952 9.24906 2.01206 9.04653 2.2619 9.04653Z" fill="black"/>
        <path fill-rule="evenodd" clip-rule="evenodd" d="M0 4.97515C0 4.72531 0.202538 4.52278 0.452381 4.52278H18.5476C18.7975 4.52278 19 4.72531 19 4.97515V9.4989C19 9.74874 18.7975 9.95128 18.5476 9.95128H0.452381C0.202538 9.95128 0 9.74874 0 9.4989V4.97515ZM0.904762 5.42753V9.04653H18.0952V5.42753H0.904762Z" fill="black"/>
        <path fill-rule="evenodd" clip-rule="evenodd" d="M9.5 4.52278C9.74984 4.52278 9.95238 4.72531 9.95238 4.97515V18.5464C9.95238 18.7962 9.74984 18.9988 9.5 18.9988C9.25016 18.9988 9.04762 18.7962 9.04762 18.5464V4.97515C9.04762 4.72531 9.25016 4.52278 9.5 4.52278Z" fill="black"/>
        <path fill-rule="evenodd" clip-rule="evenodd" d="M5.42857 0.903774C4.94866 0.903774 4.4884 1.09442 4.14904 1.43376C3.80969 1.77311 3.61905 2.23336 3.61905 2.71327C3.61905 3.19318 3.80969 3.65344 4.14904 3.99278C4.4884 4.33213 4.94866 4.52277 5.42857 4.52277H8.91432C8.90292 4.48497 8.89078 4.44562 8.87788 4.40488C8.74942 3.99923 8.54794 3.46316 8.2554 2.93128C7.65986 1.84849 6.76034 0.903774 5.42857 0.903774ZM9.5 4.97515C9.9436 4.88643 9.94356 4.88627 9.94353 4.88609L9.94319 4.88443L9.94245 4.88079L9.93992 4.86866C9.93776 4.85845 9.93466 4.84405 9.93057 4.82574C9.92239 4.78913 9.91026 4.73682 9.89381 4.67105C9.86095 4.5396 9.81076 4.35384 9.74043 4.13175C9.60028 3.68919 9.37766 3.09433 9.04817 2.49527C8.39967 1.31618 7.26347 -0.000976562 5.42857 -0.000976562C4.7087 -0.000976562 4.01831 0.284988 3.50928 0.794009C3.00025 1.30303 2.71429 1.99341 2.71429 2.71327C2.71429 3.43314 3.00025 4.12352 3.50928 4.63254C4.01831 5.14156 4.7087 5.42753 5.42857 5.42753H9.5C9.63553 5.42753 9.76392 5.36676 9.84985 5.26195C9.93577 5.15714 9.97011 5.01898 9.94353 4.88609L9.5 4.97515Z" fill="black"/>
        <path fill-rule="evenodd" clip-rule="evenodd" d="M9.95183 2.49527C10.6003 1.31618 11.7365 -0.000976562 13.5714 -0.000976562C14.2913 -0.000976562 14.9817 0.284988 15.4907 0.794009C15.9997 1.30303 16.2857 1.99341 16.2857 2.71327C16.2857 3.43314 15.9997 4.12352 15.4907 4.63254C14.9817 5.14156 14.2913 5.42753 13.5714 5.42753H9.5C9.36447 5.42753 9.23608 5.36676 9.15016 5.26195C9.06423 5.15714 9.02982 5.01933 9.0564 4.88643L9.5 4.97515C9.05641 4.88643 9.05637 4.88661 9.0564 4.88643L9.05681 4.88443L9.05755 4.88079L9.06008 4.86866C9.06224 4.85845 9.06534 4.84405 9.06943 4.82574C9.07761 4.78913 9.08975 4.73682 9.10619 4.67105C9.13905 4.5396 9.18925 4.35384 9.25957 4.13175C9.39972 3.68919 9.62234 3.09433 9.95183 2.49527ZM10.0857 4.52277H13.5714C14.0513 4.52277 14.5116 4.33213 14.851 3.99278C15.1903 3.65344 15.381 3.19318 15.381 2.71327C15.381 2.23336 15.1903 1.77311 14.851 1.43376C14.5116 1.09442 14.0513 0.903774 13.5714 0.903774C12.2397 0.903774 11.3401 1.84849 10.7446 2.93128C10.4521 3.46316 10.2506 3.99923 10.1221 4.40488C10.1092 4.44562 10.0971 4.48497 10.0857 4.52277Z" fill="black"/>
    </svg>
    <span>Подарочный сертификат
        <?if(!$arResult['IS_MOBILE']):?>
        <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" class="digift-info_btn">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M7.5 1.00098C3.91014 1.00098 1 3.91109 1 7.50089C1 11.0907 3.91014 14.0008 7.5 14.0008C11.0899 14.0008 14 11.0907 14 7.50089C14 3.91109 11.0899 1.00098 7.5 1.00098ZM0 7.50089C0 3.35879 3.35787 0.000976562 7.5 0.000976562C11.6421 0.000976562 15 3.35879 15 7.50089C15 11.643 11.6421 15.0008 7.5 15.0008C3.35787 15.0008 0 11.643 0 7.50089ZM7.5 7.00195C7.77614 7.00195 8 7.22581 8 7.50195V10.3019C8 10.5781 7.77614 10.8019 7.5 10.8019C7.22386 10.8019 7 10.5781 7 10.3019V7.50195C7 7.22581 7.22386 7.00195 7.5 7.00195ZM7.5 4.20136C7.22386 4.20136 7 4.42522 7 4.70136C7 4.97751 7.22386 5.20136 7.5 5.20136H7.50804C7.78418 5.20136 8.00804 4.97751 8.00804 4.70136C8.00804 4.42522 7.78418 4.20136 7.50804 4.20136H7.5Z"/>
        </svg>
        <div class="digift-info">
            <b>Нет сертификата?</b>
            <div>
                Выберите номинал, дизайн, напишите поздравление и отправьте получателю
            </div>
            <a href="/pages/gift-certificates/">
                Купить в подарок
                <svg width="25" height="9" viewBox="0 0 25 9" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M20.2007 0L25 4.5L20.2007 9L19.5188 8.33947L23.1195 4.9633H0V4.0367H23.1195L19.5188 0.660527L20.2007 0Z" fill="#FE4A5B"/>
                </svg>
            </a>
        </div>
        <?endif;?>
    </span>
    <svg width="17" height="9" viewBox="0 0 17 9" fill="none" xmlns="http://www.w3.org/2000/svg" class="checkout-digift_btn-arrow">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M0.232069 0.22379C-0.0773563 0.523477 -0.0773543 1.00937 0.232069 1.30905L7.93974 8.77414C8.24916 9.07383 8.75084 9.07383 9.06027 8.77414L16.7679 1.30905C17.0774 1.00936 17.0774 0.523476 16.7679 0.223789C16.4585 -0.0758984 15.9568 -0.0758981 15.6474 0.223789L8.5 7.14625L1.3526 0.22379C1.04317 -0.0758968 0.541494 -0.075897 0.232069 0.22379Z" fill="#9D9C9C"/>
    </svg>
</div>
<div class="checkout-digift_container">
    <?if(isset($arResult['DIGIFT']) && !empty($arResult['DIGIFT']['CARD_CODE']) && !empty($arResult['DIGIFT']['BALANCE_AMOUNT'])) {?>
    <form id="digift-form_delete" action="<?=POST_FORM_ACTION_URI?>" method="POST" enctype="multipart/form-data">
        <?=bitrix_sessid_post()?>
        <input type="hidden" name="action" value="delete_digift">
        <input name="card" placeholder="Номер карты" type="hidden" value="<?=$arResult['DIGIFT']['CARD_CODE'];?>">
        <div class="digift-form_inputs">
            <input name="card" placeholder="Номер карты" type="text" autocomplete="off" value="<?=$arResult['DIGIFT']['CARD_CODE']?>" readonly>
            <input name="pin" placeholder="Пин-код" type="text" autocomplete="off" value="" readonly>
        </div>
        <button type="submit">Удалить</button>
    </form>
    <span class="checkout-digift_balance">
        <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M14 7.5C14 11.0899 11.0899 14 7.5 14C3.91015 14 1 11.0899 1 7.5C1 3.91015 3.91015 1 7.5 1C11.0899 1 14 3.91015 14 7.5ZM15 7.5C15 11.6421 11.6421 15 7.5 15C3.35786 15 0 11.6421 0 7.5C0 3.35786 3.35786 0 7.5 0C11.6421 0 15 3.35786 15 7.5ZM9.78233 5.3585L6.71177 8.42906L5.35327 7.07056L4.64616 7.77767L6.35822 9.48972L6.71177 9.84328L7.06533 9.48972L10.4894 6.06561L9.78233 5.3585Z" fill="#51C12A"/>
        </svg>
        Ваш баланс <?=rtrim(rtrim(number_format(($arResult['DIGIFT']['BALANCE_AMOUNT']),2,'.',' '),'0'),'.')?> ₽
    </span>
    <?} else {?>
    <form id="digift-form_add" action="<?=POST_FORM_ACTION_URI?>" method="POST" enctype="multipart/form-data">
        <?=bitrix_sessid_post()?>
        <input type="hidden" name="action" value="add_digift">
        <div class="digift-form_inputs">
        <input name="card" placeholder="Номер" type="text" autocomplete="off" value="">
        <input name="pin" placeholder="Пин-код" type="password" autocomplete="off" value="">
        </div>
        <button type="submit">Применить</button>
    </form>
    <?if(isset($arResult['DIGIFT']) && $arResult['DIGIFT']['error']){?>
        <span class="checkout-digift_error">
            <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M14 7.5C14 11.0899 11.0899 14 7.5 14C3.91015 14 1 11.0899 1 7.5C1 3.91015 3.91015 1 7.5 1C11.0899 1 14 3.91015 14 7.5ZM15 7.5C15 11.6421 11.6421 15 7.5 15C3.35786 15 0 11.6421 0 7.5C0 3.35786 3.35786 0 7.5 0C11.6421 0 15 3.35786 15 7.5ZM10.4999 9.74954L9.74988 10.4995L7.50025 8.24999L5.25006 10.5L4.50008 9.7501L6.75027 7.50006L4.5 5.24993L5.24998 4.5L7.50025 6.75012L9.74996 4.50056L10.4999 5.2505L8.25024 7.50006L10.4999 9.74954Z" fill="#FE4A5B"/>
            </svg>
            <?=$arResult['DIGIFT']['message']?>
        </span>
    <?}?>
    <?}?>
</div>
</div>

<script>
BX.ready(function(){
    BX.bindDelegate(
        BX('checkout-digift'), 'mouseover', {className: 'digift-info_btn' },
        function(e){
            if(!e) {
               e = window.event;
            }
            if(BX.hasClass(this,'active') == false) {
                BX.addClass(this,'active');
            } else {
                BX.removeClass(this,'active');
            }
        }
    );
    BX.bindDelegate(
        BX('checkout-digift'), 'click', {className: 'digift-info_btn' },
        function(e){
            if(!e) {
               e = window.event;
            }
            if(BX.hasClass(this,'active') == false) {
                BX.addClass(this,'active');
            } else {
                BX.removeClass(this,'active');
            }
        }
    );
});
</script>